# Fix simulation dimension. Slice into 4 or more equal sections in the z direction.
# Using a fixed number of Si atoms per section use each section's designated SiOx ratio to 
# randomly place O atoms.
# Anneal to get well distributed SiOx with Oxygen gradient

clear
units         real
dimension     3
boundary    p p f
atom_style  charge

#atom_modify map array
variable seed equal 12345

variable dt equal 1
#timestep of 0.5 femptoseconds
variable printevery equal 10000
variable restartevery equal 0#500000
variable datapath string "${output_folder}data/"

shell mkdir ${datapath}

variable massSi equal 28.0855 #Si
variable massO equal 15.9991 #O
variable massH equal  1.00784 #H 
variable NA equal 6.02e23 #avagadros

#fix the number of Si per section
variable numSi equal 320

variable density equal 2.5 #approximate density
variable latticeConst equal 5.43

variable zExtent equal $(30/v_latticeConst) #$(v_volume/(v_xyExtent^2))
variable zE1 equal $(v_zExtent/4)
variable zE2 equal $(v_zExtent/2)
variable zE3 equal $(3*v_zExtent/4)

variable xyExtent equal 5 #number of Si lattice wide



#creating interfaces with c-Si in future so we want x and y to be multiples of the lattice const


lattice diamond ${latticeConst} 

region sim block 0 ${xyExtent} 0 ${xyExtent} 0 ${zExtent}
region region1 block 0 ${xyExtent} 0 ${xyExtent} 0 ${zE1}
region region2 block 0 ${xyExtent} 0 ${xyExtent} ${zE1} ${zE2}
region region3 block 0 ${xyExtent} 0 ${xyExtent} ${zE2} ${zE3}
region region4 block 0 ${xyExtent} 0 ${xyExtent} ${zE3} ${zExtent}



create_box 3 sim

create_atoms 3 random 300 ${seed} region1 overlap .3 maxtry 1000
create_atoms 2 random 600 ${seed} region1 overlap .3 maxtry 1000

create_atoms 3 random 320 ${seed} region2 overlap .3 maxtry 1000
create_atoms 2 random 550 ${seed} region2 overlap .3 maxtry 1000

create_atoms 3 random 325 ${seed} region3 overlap .3 maxtry 1000
create_atoms 2 random 500 ${seed} region3 overlap .3 maxtry 1000

create_atoms 3 random 330 ${seed} region4 overlap .3 maxtry 1000
create_atoms 2 random 450 ${seed} region4 overlap .3 maxtry 1000


mass         1 ${massH}
mass         2 ${massO}
mass         3 ${massSi}

pair_style	    reaxff potential/topcon.control
pair_coeff	    * * potential/ffield_Nayir_SiO_2019.reax H O Si
#Pair style reaxff requires use of exactly one of the fix qeq/reaxff or fix qeq/shielded or fix acks2/reaxff commands 


neighbor        2 bin
neigh_modify    every 10 delay 0 check no

timestep ${dt}


dump d1 all custom ${printevery} ${output_folder}CreateSiOx.dump id type q x y z ix iy iz mass element vx vy vz
dump_modify d1 element H O Si

thermo ${printevery}
thermo_style custom step temp density vol pe ke etotal #flush yes



#qeq/reax uses the Rappe and Goddard QEq technique which was used in the potential in Fogarty2010(p2) that this current potential is. based on 
fix r1 all qeq/reax 1 0.0 10.0 1e-6 reaxff

# fix wall1 all wall/region region1 lj93 1.0 1.0 2.5
# fix wall2 all wall/region region2 lj93 1.0 1.0 2.5
# fix wall3 all wall/region region3 lj93 1.0 1.0 2.5
# fix wall4 all wall/region region4 lj93 1.0 1.0 2.5

#heat way the f up
fix f1 all nvt temp 3000 3000 100
run $(20000*(1/v_dt))#divide by timestep to make the run time in fs
unfix f1

fix f1 all nvt temp 300 300 100
run $(20000*(1/v_dt))#divide by timestep to make the run time in fs
unfix f1

unfix wall1
unfix wall2
unfix wall3
unfix wall4


#only allow demorphing in the z dimension
fix f1 all npt temp 800 800 100 z 1 1 5000
run $(20000*(1/v_dt))#divide by timestep to make the run time in fs
unfix f1

fix f1 all npt temp 800 300 100 z 1 1 5000
run $(200000*(1/v_dt))#divide by timestep to make the run time in fs
unfix f1

min_style hftn
minimize 1.0e-8 1.0e-8 100000 100000

#must have made new dir data above
write_data ${datapath}SiOGrad.data

print 'done'





